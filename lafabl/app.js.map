{"version":3,"sources":["app/initialize.js","app/sorter.js"],"names":["Sorter","require","document","addEventListener","console","log","sorter","Papa","Array","prototype","minBy","fn","extremumBy","Math","min","maxBy","max","pluck","extremum","reduce","best","next","pair","apply","module","exports","box","getElementById","handle_drag_over","event","handle_file_select","stopPropagation","preventDefault","dataTransfer","dropEffect","loaded","file","files","parse_csv","callback","parse","header","complete","results","handle_data","data","players","row","player","name","trim","toLowerCase","skill","parseInt","teammate_request","push","pick_teams","team_value","team","map","a","b","teams","sorted_by_skill","entries","sort","datum","lowest_value_team","team_with_request","find","some","e","undefined","iterator","team_div","createElement","className","team_title_div","innerHTML","appendChild","player_div","score_div"],"mappings":"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","file":"public/app.js","sourcesContent":["var Sorter = require('sorter')\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  // do your setup here\n  console.log('Initialized app');\n  var sorter = new Sorter()\n});\n","var Papa = require('papaparse')\n\nArray.prototype.minBy = function(fn) { return this.extremumBy(fn, Math.min); };\n\nArray.prototype.maxBy = function(fn) { return this.extremumBy(fn, Math.max); };\n\nArray.prototype.extremumBy = function(pluck, extremum) {\n  return this.reduce(function(best, next) {\n    var pair = [ pluck(next), next ];\n    if (!best) {\n       return pair;\n    } else if (extremum.apply(null, [ best[0], pair[0] ]) == best[0]) {\n       return best;\n    } else {\n       return pair;\n    }\n  },null)[1];\n}\n\nmodule.exports = class Sorter {\n  constructor() {\n    this.box = document.getElementById('drag-box')\n    this.box.addEventListener('dragover', () => this.handle_drag_over(event), false)\n    this.box.addEventListener('drop', () => this.handle_file_select(event), false)\n  }\n\n  handle_drag_over(event) {\n    event.stopPropagation()\n    event.preventDefault()\n\n    event.dataTransfer.dropEffect = 'link'\n    return\n  }\n\n  handle_file_select(event) {\n    event.stopPropagation()\n    event.preventDefault()\n\n    var loaded = false\n    var file = event.dataTransfer.files[0]\n\n    this.parse_csv(file)\n    return\n  }\n\n  parse_csv(file, callback) {\n    Papa.parse(file, {header: true, complete: (results) => this.handle_data(results.data)})\n  }\n\n  handle_data(data) {\n    var players = []\n    for (var row of data) {\n      if (row[\"Submission Date\"] != \"\") {\n        var player = {\n          name: row[\"First Name\"].trim().toLowerCase() + \" \" + row[\"Last Name\"].trim().toLowerCase(),\n          skill: parseInt(row[\"In order to help us select fair teams, please rank your basketball skill (we think everyone is great at basketball!):\"]),\n          teammate_request: row[\"Teams are \\\"randomly drafted\\\" by Effie and Aerienne. You are allowed to choose *one* friend that you would like to be on the same team with -- we will try to accomodate your request!\"]\n        }\n        players.push(player)\n      }\n    }\n\n    this.pick_teams(players)\n  }\n\n  pick_teams(data) {\n    function team_value(team) {\n      return team.map((a) => a.skill).reduce((a, b) => a + b, 0)\n    }\n\n    var teams = []\n    teams[0] = []\n    teams[1] = []\n    teams[2] = []\n    teams[3] = []\n\n    var sorted_by_skill = [...data.entries()].sort((a,b) => a[1].skill > b[1].skill ? -1 : a[1].skill < b[1].skill ? 1 : 0)\n\n    for (var datum of sorted_by_skill) {\n      var player = datum[1]\n      var lowest_value_team = teams.minBy((a) => team_value(a))\n      var team_with_request = teams.find((a) => a.some((e) => e.name == player.teammate_request.trim().toLowerCase()))\n\n      if (team_with_request == undefined) {\n        lowest_value_team.push(player)\n      }\n      else {\n        console.log('request filled! ' + player.name + ' requested ' + player.teammate_request)\n        team_with_request.push(player)\n      }\n    }\n\n    var iterator = 1\n    for (var team of teams) {\n      var team_div = document.createElement(\"div\")\n      team_div.className = \"team-container\"\n\n      var team_title_div = document.createElement(\"div\")\n      team_title_div.className = \"team\"\n      team_title_div.innerHTML = \"Team \" + iterator\n\n      this.box.appendChild(team_div)\n      team_div.appendChild(team_title_div)\n\n      for (var player of team) {\n        var player_div = document.createElement(\"div\")\n        player_div.className = \"player\"\n        player_div.innerHTML = player.name\n        team_div.appendChild(player_div)\n      }\n\n      var score_div = document.createElement(\"div\")\n      score_div.className = \"score\"\n      score_div.innerHTML = team_value(team)\n      team_div.appendChild(score_div)\n      iterator += 1\n    }\n  }\n}\n"]}