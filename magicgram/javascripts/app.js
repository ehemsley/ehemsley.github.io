!function(){"use strict";var t="undefined"==typeof window?global:window;if("function"!=typeof t.require){var e={},n={},r={},a={}.hasOwnProperty,i="components/",o=function(t,e){var n=0;e&&(0===e.indexOf(i)&&(n=i.length),e.indexOf("/",n)>0&&(e=e.substring(n,e.indexOf("/",n))));var a=r[t+"/index.js"]||r[e+"/deps/"+t+"/index.js"];return a?i+a.substring(0,a.length-".js".length):t},s=/^\.\.?(\/|$)/,h=function(t,e){for(var n,r=[],a=(s.test(e)?t+"/"+e:e).split("/"),i=0,o=a.length;o>i;i++)n=a[i],".."===n?r.pop():"."!==n&&""!==n&&r.push(n);return r.join("/")},c=function(t){return t.split("/").slice(0,-1).join("/")},l=function(e){return function(n){var r=h(c(e),n);return t.require(r,e)}},u=function(t,e){var r={id:t,exports:{}};return n[t]=r,e(r.exports,l(t),r),r.exports},f=function(t,r){var i=h(t,".");if(null==r&&(r="/"),i=o(t,r),a.call(n,i))return n[i].exports;if(a.call(e,i))return u(i,e[i]);var s=h(i,"./index");if(a.call(n,s))return n[s].exports;if(a.call(e,s))return u(s,e[s]);throw new Error('Cannot find module "'+t+'" from "'+r+'"')};f.alias=function(t,e){r[e]=t},f.register=f.define=function(t,n){if("object"==typeof t)for(var r in t)a.call(t,r)&&(e[r]=t[r]);else e[t]=n},f.list=function(){var t=[];for(var n in e)a.call(e,n)&&t.push(n);return t},f.brunch=!0,f._cache=n,t.require=f}}(),require.register("initialize",function(t,e,n){var r,a;r=e("application"),a=new r}),require.register("application",function(t,e,n){var r,a;a=e("canvas_controller"),n.exports=r=function(){function t(){this.canvas_controller=new a}return t}()}),require.register("canvas_controller",function(t,e,n){var r,a=function(t,e){return function(){return t.apply(e,arguments)}};n.exports=r=function(){function t(){this.HandleFileSelect=a(this.HandleFileSelect,this),this.HandleDragOver=a(this.HandleDragOver,this),this.ClearCanvas=a(this.ClearCanvas,this),this.DrawStereogram=a(this.DrawStereogram,this),this.DrawIntroText=a(this.DrawIntroText,this);var t;this.canvas=document.createElement("canvas"),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.canvas.style.width=this.canvas.width+"px",this.canvas.style.height=this.canvas.height+"px",this.canvas.setAttribute("id","canvasID"),t=document.getElementById("canvas-container"),t.appendChild(this.canvas),this.context=this.canvas.getContext("2d"),this.context.textAlign="center",this.context.textBaseline="center",this.canvas.addEventListener("dragover",this.HandleDragOver,!1),this.canvas.addEventListener("drop",this.HandleFileSelect,!1),this.DrawIntroText()}return t.prototype.DrawIntroText=function(){this.context.font="50px Arial",this.context.fillText("MagicGram",.5*this.canvas.width,.33*this.canvas.height),this.context.font="30px Arial",this.context.fillText("Drag an image into the window to begin.",.5*this.canvas.width,.5*this.canvas.height)},t.prototype.GenerateGrayscaleMatrix=function(t,e,n){var r,a,i,o,s,h,c,l,u,f,d,v,p,g,w,x,m,D;for(o=document.createElement("canvas"),o.width=e,o.height=n,s=o.getContext("2d"),s.drawImage(this.canvas,0,0),this.ClearCanvas(),h=function(){var t,e,n;for(n=[],t=0,e=(o.height-1)*(o.width-1);e>=0?e>=t:t>=e;e>=0?t++:t--)n.push(0);return n}(),c=function(){var t,e,n;for(n=[],t=0,e=o.width-1;e>=0?e>=t:t>=e;e>=0?t++:t--)n.push(function(){var t,e,n;for(n=[],t=0,e=o.height-1;e>=0?e>=t:t>=e;e>=0?t++:t--)n.push(0);return n}());return n}(),u=s.getImageData(0,0,o.width,o.height),i=u.data,a=0,l=p=0,x=i.length;x>p;l=p+=4)f=i[l],r=.34*i[l]+.5*i[l+1]+.16*i[l+2],h[a]=Math.floor(r),a+=1;for(d=g=0,m=o.width-1;m>=0?m>=g:g>=m;d=m>=0?++g:--g)for(v=w=0,D=o.height-1;D>=0?D>=w:w>=D;v=D>=0?++w:--w)c[d][v]=255-h[d+o.width*v];return c},t.prototype.GenerateRandomDotCanvas=function(t,e,n){var r,a,i,o,s,h,c,l,u,f,d;for(i=document.createElement("canvas"),i.width=e,i.height=n,o=i.getContext("2d"),a=function(){var t,r,a;for(a=[],t=0,r=e-1;r>=0?r>=t:t>=r;r>=0?t++:t--)a.push(function(){var t,e,r;for(r=[],t=0,e=n-1;e>=0?e>=t:t>=e;e>=0?t++:t--)r.push(0);return r}());return a}(),s=l=0,f=e-1;f>=0?f>=l:l>=f;s=f>=0?++l:--l)for(c=u=0,d=n-1;d>=0?d>=u:u>=d;c=d>=0?++u:--u)if(0===a[s][c])for(o.fillStyle="rgb("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+")",h=s;e>h;)o.fillRect(h,c,1,1),a[h][c]=1,r=100+Math.floor(.125*t[h][c]),h+=r;return i},t.prototype.DrawStereogram=function(t,e){var n,r;n=this.GenerateGrayscaleMatrix(this.canvas,t,e),r=this.GenerateRandomDotCanvas(n,t,e),this.context.drawImage(r,parseInt(.5*(this.canvas.width-t)),parseInt(.5*(this.canvas.height-e))),cancelAnimationFrame(this.spinnerFrame)},t.prototype.ClearCanvas=function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.HandleDragOver=function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="link"},t.prototype.HandleFileSelect=function(t){var e,n,r,a=this;t.stopPropagation(),t.preventDefault(),r=!1,e=t.dataTransfer.files[0],this.ClearCanvas(),this.context.fillText("Processing image...",.5*this.canvas.width,.5*this.canvas.height),n=document.createElement("img"),n.src=window.URL.createObjectURL(e),n.onload=function(){return a.context.drawImage(n,0,0),a.DrawStereogram(n.width,n.height),window.URL.revokeObjectURL(a.src)}},t}()});